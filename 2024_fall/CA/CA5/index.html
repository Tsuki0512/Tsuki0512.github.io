
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="wyr">
      
      
        <link rel="canonical" href="https://tsuki0512.github.io/2024_fall/CA/CA5/">
      
      
        <link rel="prev" href="../CA4/">
      
      
        <link rel="next" href="../../OS/final_review/">
      
      
      <link rel="icon" href="../../../assets/hzhf.jpg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>DLP和TLP - wyr's notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dlp-and-tlp" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="wyr&#39;s notes" class="md-header__button md-logo" aria-label="wyr's notes" data-md-component="logo">
      
  <img src="../../../assets/hzhf.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            wyr's notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DLP和TLP
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Tsuki0512/Tsuki0512.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Wyr's Notes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="wyr&#39;s notes" class="md-nav__button md-logo" aria-label="wyr's notes" data-md-component="logo">
      
  <img src="../../../assets/hzhf.jpg" alt="logo">

    </a>
    wyr's notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Tsuki0512/Tsuki0512.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Wyr's Notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    专业课程
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            专业课程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据结构基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            数据结构基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FDS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期中前内容
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FDS2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FDS3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    排序
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dip%E5%8E%86%E5%B9%B4%E5%8D%B7%E6%95%B4%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图像信息处理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E9%80%BB%E6%9C%9F%E6%9C%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数字逻辑设计
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ADS_%E5%A4%8D%E4%B9%A0%E6%95%B4%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高级数据结构与算法分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据库系统
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            数据库系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cheatingsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../minisql%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minisql分析
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    计算机体系结构
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            计算机体系结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../final_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期末复习
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CA1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机设计基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CA2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    流水线
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CA3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    内存层次
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CA4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    指令级并行
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    DLP和TLP
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    DLP和TLP
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      0 Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-simd-vector-processor" class="md-nav__link">
    <span class="md-ellipsis">
      1 SIMD: vector processor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1 SIMD: vector processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-vector-processor" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Vector Processor处理模式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-vector-processor-example-cray-1" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Vector Processor Example - Cray-1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2 Vector Processor Example - Cray-1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121" class="md-nav__link">
    <span class="md-ellipsis">
      1.2.1 基本架构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-instruction-types-of-cray-1" class="md-nav__link">
    <span class="md-ellipsis">
      1.2.2 Instruction Types of CRAY-1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123-improve-the-performance-of-vector-processor" class="md-nav__link">
    <span class="md-ellipsis">
      1.2.3 Improve the Performance of Vector Processor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 现代向量处理机模型与技术
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.3 现代向量处理机模型与技术">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-rv64v" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.1 RV64V
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-multiple-lanes-beyond-one-element-per-clock-cycle" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.2 Multiple Lanes: Beyond One Element per Clock Cycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-gather-scatter" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.3 Gather-scatter: 使用向量结构处理矩阵运算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-simd-array-processor" class="md-nav__link">
    <span class="md-ellipsis">
      2 SIMD: array processor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 SIMD: array processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-distributed-memory-" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Distributed memory - 分布式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-centralized-shared-memory-" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Centralized shared memory - 集中共享式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-parallel-computer-design" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Parallel computer design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-single-stage-interconnection-network" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Single-stage interconnection network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 Single-stage interconnection network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cube" class="md-nav__link">
    <span class="md-ellipsis">
      1. Cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pm2i" class="md-nav__link">
    <span class="md-ellipsis">
      2. PM2I
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-shuffle-exchange-network" class="md-nav__link">
    <span class="md-ellipsis">
      3. Shuffle exchange network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    <span class="md-ellipsis">
      Others
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-multi-stage-interconnection-network-" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Multi-stage interconnection network - 多级网络不考
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-dlp-in-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      3 DLP in GPU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 DLP in GPU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#programming-the-gpu-cuda" class="md-nav__link">
    <span class="md-ellipsis">
      Programming the GPU: CUDA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grid-thread-blocks-and-threads" class="md-nav__link">
    <span class="md-ellipsis">
      Grid, Thread Blocks and Threads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu-memory-structures" class="md-nav__link">
    <span class="md-ellipsis">
      GPU memory structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loop-level-parallelism-llp" class="md-nav__link">
    <span class="md-ellipsis">
      Loop-Level Parallelism (LLP)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mimd-tread-level-parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      MIMD: Tread-level Parallelism
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MIMD: Tread-level Parallelism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shared-memory-system" class="md-nav__link">
    <span class="md-ellipsis">
      Shared Memory System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-passing-system" class="md-nav__link">
    <span class="md-ellipsis">
      Message Passing System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimd-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      MIMD Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MIMD Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uma" class="md-nav__link">
    <span class="md-ellipsis">
      UMA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numa" class="md-nav__link">
    <span class="md-ellipsis">
      NUMA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coma" class="md-nav__link">
    <span class="md-ellipsis">
      COMA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache-coherence" class="md-nav__link">
    <span class="md-ellipsis">
      Cache Coherence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cache Coherence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-consistency-vs-cache-coherence" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Consistency VS Cache Coherence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coherence" class="md-nav__link">
    <span class="md-ellipsis">
      Coherence的保障
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snoopy-coherence-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      Snoopy Coherence Protocols
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/final_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    操作系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    计算理论
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            计算理论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Lec1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Lec2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CN/CN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机网络
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../2025_spring/cp/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    编译原理
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            编译原理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/midterm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期中梳理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lexical Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parsing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Abstract Syntax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantic Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/type_checking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Type Checking (期末梳理版)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap6_for_final/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Activation Record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap7_for_final/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IR Trees
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Blocks and Traces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instruction Selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Liveness Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Register Allocation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Garbage Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Object-Oriented Languages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/cp/chap18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loop Optimizations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    软件工程（学习中）
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            软件工程（学习中）
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/se/final/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期末刷题记录
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_12" >
        
          
          <label class="md-nav__link" for="__nav_2_12" id="__nav_2_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    自然语言处理导论（待完善）
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_12">
            <span class="md-nav__icon md-icon"></span>
            自然语言处理导论（待完善）
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/nlp/DeepLearningBasics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deep Learning Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/nlp/WordEmbedding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Word Embedding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/nlp/ConvolutionalNeuralNetworks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convolutional Neural Networks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/nlp/RecurrentNeuralNetworks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recurrent Neural Networks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/nlp/Attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/nlp/NLGAndNMT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NLGandNMT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/nlp/Transformer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transformers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_13" >
        
          
          <label class="md-nav__link" for="__nav_2_13" id="__nav_2_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数理基础课程资源汇总
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_13">
            <span class="md-nav__icon md-icon"></span>
            数理基础课程资源汇总
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    离散数学及其应用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BE%AE%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    微积分（甲）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E7%89%A9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    大学物理（乙）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BA%BF%E4%BB%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性代数（甲）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C程序设计基础
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    论文阅读
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            论文阅读
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2025_spring/%E5%A4%9A%E6%A8%A1%E6%80%81/paper%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多模态大模型
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    课程心得
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            课程心得
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%80%9A%E8%AF%86%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    通识课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E7%90%86%E5%9F%BA%E7%A1%80%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数理基础课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E4%B8%93%E4%B8%9A%E5%BF%85%E4%BF%AE%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    专业必修课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E4%B8%93%E4%B8%9A%E9%80%89%E4%BF%AE%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    专业选修课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A2%8E%E7%A2%8E%E5%BF%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一些碎碎念
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    CMU_DeepVision项目记录
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CMU_DeepVision项目记录
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_prelearning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线上课程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../pytorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pytorch入门
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0807/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec1 - Transformers and RAG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0807_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec2 - Ray Tracing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0809/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec3 - 3D Vision
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0816/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec4 - Deep Learning Basics and Adversarial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      0 Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-simd-vector-processor" class="md-nav__link">
    <span class="md-ellipsis">
      1 SIMD: vector processor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1 SIMD: vector processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-vector-processor" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Vector Processor处理模式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-vector-processor-example-cray-1" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Vector Processor Example - Cray-1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2 Vector Processor Example - Cray-1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121" class="md-nav__link">
    <span class="md-ellipsis">
      1.2.1 基本架构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-instruction-types-of-cray-1" class="md-nav__link">
    <span class="md-ellipsis">
      1.2.2 Instruction Types of CRAY-1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123-improve-the-performance-of-vector-processor" class="md-nav__link">
    <span class="md-ellipsis">
      1.2.3 Improve the Performance of Vector Processor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 现代向量处理机模型与技术
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.3 现代向量处理机模型与技术">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-rv64v" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.1 RV64V
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-multiple-lanes-beyond-one-element-per-clock-cycle" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.2 Multiple Lanes: Beyond One Element per Clock Cycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-gather-scatter" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.3 Gather-scatter: 使用向量结构处理矩阵运算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-simd-array-processor" class="md-nav__link">
    <span class="md-ellipsis">
      2 SIMD: array processor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 SIMD: array processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-distributed-memory-" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Distributed memory - 分布式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-centralized-shared-memory-" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Centralized shared memory - 集中共享式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-parallel-computer-design" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Parallel computer design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-single-stage-interconnection-network" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Single-stage interconnection network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 Single-stage interconnection network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cube" class="md-nav__link">
    <span class="md-ellipsis">
      1. Cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pm2i" class="md-nav__link">
    <span class="md-ellipsis">
      2. PM2I
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-shuffle-exchange-network" class="md-nav__link">
    <span class="md-ellipsis">
      3. Shuffle exchange network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    <span class="md-ellipsis">
      Others
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-multi-stage-interconnection-network-" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Multi-stage interconnection network - 多级网络不考
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-dlp-in-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      3 DLP in GPU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 DLP in GPU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#programming-the-gpu-cuda" class="md-nav__link">
    <span class="md-ellipsis">
      Programming the GPU: CUDA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grid-thread-blocks-and-threads" class="md-nav__link">
    <span class="md-ellipsis">
      Grid, Thread Blocks and Threads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu-memory-structures" class="md-nav__link">
    <span class="md-ellipsis">
      GPU memory structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loop-level-parallelism-llp" class="md-nav__link">
    <span class="md-ellipsis">
      Loop-Level Parallelism (LLP)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mimd-tread-level-parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      MIMD: Tread-level Parallelism
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MIMD: Tread-level Parallelism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shared-memory-system" class="md-nav__link">
    <span class="md-ellipsis">
      Shared Memory System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-passing-system" class="md-nav__link">
    <span class="md-ellipsis">
      Message Passing System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimd-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      MIMD Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MIMD Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uma" class="md-nav__link">
    <span class="md-ellipsis">
      UMA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numa" class="md-nav__link">
    <span class="md-ellipsis">
      NUMA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coma" class="md-nav__link">
    <span class="md-ellipsis">
      COMA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache-coherence" class="md-nav__link">
    <span class="md-ellipsis">
      Cache Coherence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cache Coherence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-consistency-vs-cache-coherence" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Consistency VS Cache Coherence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coherence" class="md-nav__link">
    <span class="md-ellipsis">
      Coherence的保障
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snoopy-coherence-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      Snoopy Coherence Protocols
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="dlp-and-tlp">DLP and TLP<a class="headerlink" href="#dlp-and-tlp" title="Permanent link">&para;</a></h1>
<p><em>对应教材Ch4, Ch5</em></p>
<h2 id="0-introduction">0 Introduction<a class="headerlink" href="#0-introduction" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://cdn.hobbitqia.cc/20231215193832.png" />
SISD - 单指令流单数据流
SIMD - 单指令流多数据流（比如向量一次传递多种数据)</p>
<ul>
<li>SIMD architectures can exploit significant data-level parallelism</li>
<li>Matrix-oriented scientific computing</li>
<li>
<p>Media-oriented image and sound processors</p>
</li>
<li>
<p>SIMD is more energy efficient than MIMD</p>
</li>
<li>SIMD allows programmer to continue to think sequentially</li>
</ul>
<p>MIMD - 多指令流多数据流</p>
<h2 id="1-simd-vector-processor">1 SIMD: vector processor<a class="headerlink" href="#1-simd-vector-processor" title="Permanent link">&para;</a></h2>
<h3 id="11-vector-processor">1.1 Vector Processor处理模式<a class="headerlink" href="#11-vector-processor" title="Permanent link">&para;</a></h3>
<p>是处理的数据类型的分类，由不同的处理器处理不同的数据类型：
* <strong>vector processor</strong> - 流水线处理器，用向量表示和处理数据
* <strong>scalar processor</strong>  - 流水线处理器，不用向量表示和处理数据</p>
<p>通常有三种处理模式：</p>
<ol>
<li>
<p>Horizontal processing method</p>
</li>
<li>
<p>Vector calculations are performed horizontally from left to right in a row.</p>
<p>横向计算，从左到右，逐个计算出后再进行下一行。对于混合运算，一直在做功能切换。</p>
<p><img alt="image-20241128110904023" src="../markdown-img/CA5.assets/image-20241128110904023.png" /></p>
</li>
<li>
<p>Problems with horizontal processing:</p>
<ul>
<li>When calculating each component, <em>RAW</em> correlation occurs, and the <em>pipeline efficiency is low</em>.</li>
<li>
<p>If a static multi-functional pipeline is used, the pipeline must be switched frequently; the throughput  of the pipeline is lower than that of sequential serial execution.</p>
<p>如果是静态的多功能流水线，我们每次都要排空才能进行下一次运算，这样的效率很低。</p>
</li>
<li>
<p>The horizontal processing method is not suitable for vector processors.</p>
</li>
</ul>
</li>
<li>
<p>Vertical processing method - 纵向计算</p>
</li>
</ol>
<p><img alt="image-20241128110927332" src="../markdown-img/CA5.assets/image-20241128110927332.png" /></p>
<p>​   The vector calculation is performed vertically from top to bottom in a column manner.</p>
<p>​   要等加法全部都做完才能做乘法。</p>
<ol>
<li>Horizontal and vertical processing method(group processing method) - 分组计算，组内纵向，组间横向</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>D = A <span class="arithmatex">\(\times\)</span> (B + C) A, B, C, D ── vector of length N</p>
<ul>
<li>
<p>Horizontal processing method</p>
<p>先计算 <span class="arithmatex">\(d_1\leftarrow a_1\times(b_1 +c_1)\)</span>，再计算 <span class="arithmatex">\(d_2\leftarrow a_2\times(b_2 +c_2)\)</span>，以此类推。写作循环可以写作：</p>
<div class="arithmatex">\[
\begin{aligned}
k_i &amp; \leftarrow b_i+c_i\\
d_i &amp; \leftarrow a_i \times k_i
\end{aligned}
\]</div>
<p>循环里的两个语句存在数据相关。因此有 N 个数据相关，需要进行 2N 次功能切换。</p>
</li>
<li>
<p>Vertical processing method</p>
<p>先计算加法，B+C 得到一个向量 K，再计算乘法，A*K 得到 D。</p>
<div class="arithmatex">\[
\begin{aligned}
K &amp; \leftarrow B + C\\
D&amp; \leftarrow A\times K
\end{aligned}
\]</div>
<p>这里只有 1 个数据相关，2 次功能切换。</p>
</li>
<li>
<p>Horizontal and vertical processing method</p>
<p>如果 N 太大了，我们不能用一个向量来直接装下所有数据，就需要多次运算。假设 <span class="arithmatex">\(N=S\times n +r\)</span>，即我们把 N 个数据分成了 S 组，每组有 n 个数据，最后一组有 r 个数据。组内做纵向运算，组间做横向运算。</p>
</li>
</ul>
</div>
<p>Requirements for processor structure: <strong>memory-memory structure</strong>.<br />
源向量和目的向量都在内存中，中间结果也需要写回内存。</p>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215195250.png" width=60%></div>

<h3 id="12-vector-processor-example-cray-1">1.2 Vector Processor Example - Cray-1<a class="headerlink" href="#12-vector-processor-example-cray-1" title="Permanent link">&para;</a></h3>
<h4 id="121">1.2.1 基本架构<a class="headerlink" href="#121" title="Permanent link">&para;</a></h4>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215195351.png" width=70%></div>

<p>有 8 个向量寄存器，每组向量寄存器有 64 位。有 12 条单功能流水线，可以并行工作。</p>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215195456.png" width=70%></div>

<p>Each vector register Vi has a separate bus connected to 6 vector functional units.</p>
<p>不同的功能需要的拍数不同。</p>
<p>向量的指令也是可能存在相关性：  </p>
<ul>
<li>
<p><strong>Vi conflict</strong>: The source vector or result vector of each vector instruction working in parallel uses the same Vi.</p>
<p>当向量寄存器有依赖的时候，后续指令要在前面指令的结果出来之后再执行。这里并不是等前面的向量的每一个元素都计算完，而是等前面的向量的第一个元素计算完就开始计算第一个元素的后续指令，等第二个元素计算完就开始计算第二个元素的后续指令，以此类推。</p>
<ul>
<li>
<p>Writing and reading data related</p>
<div class="arithmatex">\[
\begin{aligned}
V0 &amp; \leftarrow V1+V2\\
V3&amp; \leftarrow V0\times V4
\end{aligned}
\]</div>
</li>
<li>
<p>Reading data related</p>
<div class="arithmatex">\[
\begin{aligned}
V0 &amp; \leftarrow V1+V2\\
V3&amp; \leftarrow V4\times V1
\end{aligned}
\]</div>
</li>
</ul>
</li>
<li>
<p><strong>Functional conflict</strong>: Each vector instruction working in parallel must use the same functional unit.</p>
<div class="arithmatex">\[
\begin{aligned}
V3 &amp; \leftarrow V1\times V2\\
V5&amp; \leftarrow V4\times V6
\end{aligned}
\]</div>
<p>如果我们只有一个乘法部件，就会有结构冲突。我们只能等前一条指令全部完成（最后一个元素做完才可以），才能开始下一条指令。</p>
</li>
</ul>
<h4 id="122-instruction-types-of-cray-1">1.2.2 Instruction Types of CRAY-1<a class="headerlink" href="#122-instruction-types-of-cray-1" title="Permanent link">&para;</a></h4>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215200227.png" width=70%></div>

<ul>
<li>向量和向量</li>
<li>向量和标量</li>
<li>向量读取</li>
<li>向量存储</li>
</ul>
<p>向量加法需要 6 拍；乘法需要 7 拍；读写需要 6 拍。</p>
<h4 id="123-improve-the-performance-of-vector-processor">1.2.3 Improve the Performance of Vector Processor<a class="headerlink" href="#123-improve-the-performance-of-vector-processor" title="Permanent link">&para;</a></h4>
<ul>
<li>Set up multiple functional units and make them work in parallel. - 增加功能部件采取并行机制</li>
<li>Use <strong>link technology</strong> to speed up the execution of a string of vector instructions. - 链接技术</li>
<li>
<p>链接条件：后面的刚好要用到前面的且没有功能部件冲突，且两个操作数在同一拍准备好</p>
</li>
<li>
<p>Adopt <strong>recycling mining technology</strong> to speed up recycling processing.</p>
</li>
<li>Using a <strong>multi-processor system</strong> to further improve the performance.</li>
</ul>
<p>这里 1、3、4 都依赖于增加部件，我们将关注于第 2 种方法。</p>
<p>Link feature: It has two related instructions that are written first and then read. In the case of no conflicts between functional components and source vector conflicts, functional components can be linked for pipeline processing to achieve the purpose of speeding up execution.<br />
如果我们有两条指令，第一条指令的结果是第二条指令的输入，那么我们就可以把这两条指令链接起来，这样就可以减少一次读写的时间。</p>
<div class="admonition example">
<p class="admonition-title">Use link technology to perform vector operations on CRAY-1</p>
<p>D = A <span class="arithmatex">\(\times\)</span> (B + C)；A, B, C, D ── vector of length N，假设 <span class="arithmatex">\(N\leq 64\)</span>，均为浮点数，B 和 C 已经被存在 V0 和 V1 中。</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">V3</span><span class="w"> </span><span class="err">&lt;</span><span class="p">-</span><span class="w"> </span><span class="no">memory</span><span class="w">    </span><span class="c1">// access vector A</span>
<span class="nf">V2</span><span class="w"> </span><span class="err">&lt;</span><span class="p">-</span><span class="w"> </span><span class="no">V0</span><span class="w"> </span><span class="err">＋</span><span class="w"> </span><span class="no">V1</span><span class="w">  </span><span class="c1">// Vector B and Vector C perform floating point addition</span>
<span class="nf">V4</span><span class="w"> </span><span class="err">&lt;</span><span class="p">-</span><span class="w"> </span><span class="no">V2</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="no">V3</span><span class="w">   </span><span class="c1">// Floating point multiplication, the result is stored in V4</span>
</code></pre></div></td></tr></table></div>
这里前两条指令没有冲突，可以并行完成。第三条指令需要等前两条指令完成，存在 RAW，不能并行但可以链接。</p>
<p>这里假设把数据从寄存器送到功能部件需要一拍，功能部件的结果写回到寄存器也需要一拍。把数据从内存送到 fetch function unit 需要一拍。
<div align = center><img src="https://cdn.hobbitqia.cc/20231215201205.png" width=70%></div></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>计算下面的指令，假设三条指令串行执行；1 和 2 并行执行后执行 3；使用 link 技术，这三种情况下的拍数。
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">V3</span><span class="w"> </span><span class="err">&lt;</span><span class="p">-</span><span class="w"> </span><span class="no">A</span>
<span class="nf">V2</span><span class="w"> </span><span class="err">&lt;</span><span class="p">-</span><span class="w"> </span><span class="no">V0</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="no">V1</span>
<span class="nf">V4</span><span class="w"> </span><span class="err">&lt;</span><span class="p">-</span><span class="w"> </span><span class="no">V2</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="no">V3</span>
</code></pre></div></td></tr></table></div>
注意到向量功能内部也是流水的。</p>
<ul>
<li>
<p>The execution time using serial method. </p>
<p>经过 8 拍 V0 的第一个元素到达 V2，那么再过 (N-1) 拍 V0 的最后一个元素就会到达 V2。因此总共需要 [(1+6+1)+N-1] + [(1+6+1)+N-1] + [(1+7+1)+N-1] = 3N+22 拍。</p>
</li>
<li>
<p>The first two instructions are parallel, and the third is serial.</p>
<p>max{[(1+6+1)+N-1], [(1+6+1)+N-1]} + [(1+7+1)+N-1] = 2N+15</p>
</li>
<li>
<p>Use link technology.</p>
<p>我们只需要知道 V4 的第一个结果多久可以出来：8+1+7+1=9 拍，随后还有 (N-1) 条指令，因此总共需要的拍数为 max{(1+6+1), (1+6+1)} + (1+7+1)+N-1 = N+16.</p>
</li>
</ul>
</div>
</div>
<h3 id="13">1.3 现代向量处理机模型与技术<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<h4 id="131-rv64v">1.3.1 RV64V<a class="headerlink" href="#131-rv64v" title="Permanent link">&para;</a></h4>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215204125.png" width=70%></div>

<ul>
<li>以Cray-1为基础架构拓展出来的现代架构</li>
<li>32 62-bit vector registers<ul>
<li>Register file has 16 read ports and 8 write ports</li>
</ul>
</li>
<li>Vector functional units<ul>
<li>Fully pipelined</li>
<li>Data and control hazards are detected</li>
</ul>
</li>
<li>Vector load-store unit<ul>
<li>Fully pipelined</li>
<li>One word per clock cycle after initial latency</li>
</ul>
</li>
<li>Scalar registers<ul>
<li>31 general-purpose registers</li>
<li>32 floating-point registers</li>
</ul>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">DAXPY (Double Precision a*X plus Y)</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215204216.png" width=70%></div></p>
</div>
<p>因为循环之间没有迭代相关（和跨迭代循环的数据相关），所以可以转化为向量运算，大大减少了指令条数。</p>
<h4 id="132-multiple-lanes-beyond-one-element-per-clock-cycle">1.3.2 Multiple Lanes: Beyond One Element per Clock Cycle<a class="headerlink" href="#132-multiple-lanes-beyond-one-element-per-clock-cycle" title="Permanent link">&para;</a></h4>
<p>多通道：每个时钟周期可以处理多个元素。</p>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215204443.png" width=70%></div>

<h4 id="133-gather-scatter">1.3.3 Gather-scatter: 使用向量结构处理矩阵运算<a class="headerlink" href="#133-gather-scatter" title="Permanent link">&para;</a></h4>
<p><img alt="image-20241212131820601" src="../markdown-img/CA5.assets/image-20241212131820601.png" /></p>
<h2 id="2-simd-array-processor">2 SIMD: array processor<a class="headerlink" href="#2-simd-array-processor" title="Permanent link">&para;</a></h2>
<p>多个处理器共同协作一个任务，必须有信息交流，需要组织处理器和内存的阵列。</p>
<p>N processing elements <span class="arithmatex">\(PE_0\)</span> to <span class="arithmatex">\(PE_{N-1}\)</span> are repeatedly set.</p>
<p>不同的阵列需要互相通信以连接。</p>
<div class="admonition example">
<p class="admonition-title">ILLIAC IV</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215205010.png" width=70%></div></p>
</div>
<p>根据内存组织形式的分类：</p>
<ul>
<li>Distributed memory</li>
<li>Centralized shared memory</li>
</ul>
<h3 id="21-distributed-memory-">2.1 Distributed memory - 分布式<a class="headerlink" href="#21-distributed-memory-" title="Permanent link">&para;</a></h3>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215205259.png" width=70%></div>

<p>PE 代表处理器，PEN 是其对应的内存，ICN 是一个内部的互联网络。</p>
<p>local的内存访问会快一点，访问其他的内存会慢一点。</p>
<h3 id="22-centralized-shared-memory-">2.2 Centralized shared memory - 集中共享式<a class="headerlink" href="#22-centralized-shared-memory-" title="Permanent link">&para;</a></h3>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215205336.png" width=70%></div>

<p>网络之间会通过拓扑结构设计谁和谁联通。处理器对不同的内存没有特权之分。</p>
<h3 id="23-parallel-computer-design">2.3 Parallel computer design<a class="headerlink" href="#23-parallel-computer-design" title="Permanent link">&para;</a></h3>
<p>cpu之间的交流体系是parallel computer的关键。</p>
<p>如果我们想让任何两个处理器都互相连接，如果都是直连，那么需要 $C_n^2 $ 个连接。</p>
<p><strong>Definition</strong>: A network composed of switching units according to a certain topology and control mode to realize the interconnection between multiple processors or multiple functional components within a computer system.<br />
网络中的节点代表一个处理器单元，每条边就代表一个连接。连接的通路越短就认为效率越高。</p>
<p>连接的东西包括 CPU，内存，接口，link and switch node。</p>
<ul>
<li><strong>Interface</strong>: It is a device that obtains information from CPU and memory and sends information to another CPU and memory. Typical devices are network interface cards.</li>
<li><strong>Link</strong>: A physical channel to transmit data bits. The link can be a cable, twisted pair or optical fiber, it can be serial or parallel, and each link has its maximum bandwidth. The link can be simplex half-duplex and full-duplex, the clock mechanism used by the link can be synchronous or asynchronous.</li>
<li><strong>Switch node</strong>: It is the information exchange and control station of the interconnected network. It is a device with multiple input ports and multiple output ports which is able to perform data buffer storage and path selection.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Some key points</p>
<ul>
<li>
<ul>
<li>
<p>Static topology</p>
<p>静态网络：网络设定好后节点和边的连接方式就确定下来。</p>
</li>
</ul>
<p>Topology of interconnection network - 网络的拓扑结构</p>
<ul>
<li>
<p>Dynamic topology</p>
<p>动态网络：网络由很多开关组成，网络的连接方式会变化，如交叉开关我们拨动之后两个点的连接改变。</p>
</li>
</ul>
</li>
<li>
<p>Timing mode of interconnection network - 时序</p>
<ul>
<li>Synchronization system: Use a unified clock. Such as SIMD array processor</li>
<li>Asynchronous system: No uniform clock. Each processor in the system works independently</li>
</ul>
</li>
<li>Exchange method of interconnection network - 开关状态<ul>
<li>Circuit switching</li>
<li>Packet switching</li>
</ul>
</li>
<li>Control Strategy of interconnection network - 控制方式<ul>
<li>Centralized control mode: have a global controller</li>
<li>Distributed control mode: no global controller</li>
</ul>
</li>
</ul>
</div>
<ul>
<li>
<p><strong>Single-stage interconnection network</strong>: There are only a limited number of connections at the only level to realize information transmission between any two processing units.</p>
<p>单级网络，一个 PE 和另一个 PE 连在一起。最具体的连接方式、最基本的单元。</p>
</li>
<li>
<p><strong>Multi-stage interconnection network</strong>: It is composed of multiple single-level networks in series to realize the connection between any two processing units.</p>
<p>多级网络。多个单级网络通过某种形式连接。</p>
</li>
</ul>
<p>互联函数：N 个入端和 N 个出端会建立一个映射关系 <span class="arithmatex">\(j \leftrightarrow f(j)\)</span>。用二进制表示。</p>
<h3 id="24-single-stage-interconnection-network">2.4 Single-stage interconnection network<a class="headerlink" href="#24-single-stage-interconnection-network" title="Permanent link">&para;</a></h3>
<p>几个常用的单级的互联网络</p>
<h4 id="1-cube">1. Cube<a class="headerlink" href="#1-cube" title="Permanent link">&para;</a></h4>
<p>假设有 N 个入端和出端，表示为 <span class="arithmatex">\(P_{n-1}\ldots P_1P_0\)</span>。（用<span class="arithmatex">\(n\)</span>位二进制表示，<span class="arithmatex">\(n = log_2N\)</span>）</p>
<p>这里有 n 个不同的互联函数：（对第 i 位取反）</p>
<div class="arithmatex">\[
Cube_i(P_{n-1}\ldots P_1P_0)=P_{n-1}\ldots \overline{P_i}\ldots P_1P_0
\]</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215211043.png" width=70%></div>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215211123.png" width=70%></div>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215211141.png" width=70%></div></p>
</div>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215213606.png" width=60%></div>

<p>3D Cube 里，任意两个点最远需要 3 步。对于 N 维的 Cube（超立方体网络），任意两个点最远需要 <span class="arithmatex">\(\log_2(N)\)</span> 步。</p>
<h4 id="2-pm2i">2. PM2I<a class="headerlink" href="#2-pm2i" title="Permanent link">&para;</a></h4>
<p><strong>PM2I (Plus Minus 2i)</strong> single-stage network
$$
PM2_{+i}(j)=(j+2^i)\mod N, PM2_{-i}(j)=(j-2^i)\mod N
$$</p>
<p>实际上这里只有 <span class="arithmatex">\(2\log_2(N)-1\)</span> 个不同的函数，因为 <span class="arithmatex">\(PM2_{+\log_2(N)}\)</span> 与 <span class="arithmatex">\(PM2_{-\log_2(N)}\)</span> 是一样的。</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Example: N = 8
<div align = center><img src="https://cdn.hobbitqia.cc/20231215214203.png" width=70%></div></p>
<p>任意两点最短的互联距离是 2。（0 可以一步到 1、2、4、6、7，再过一步可以到 3、5， 而 0 和任意一个节点是等价的）</p>
</div>
<h4 id="3-shuffle-exchange-network">3. Shuffle exchange network<a class="headerlink" href="#3-shuffle-exchange-network" title="Permanent link">&para;</a></h4>
<p>混洗交换网络</p>
<p>Composed of two parts: <strong>Shuffle</strong> + <strong>Exchange</strong></p>
<p>N-dimension shuffle function:</p>
<div class="arithmatex">\[
shuffle(P_{n-1}\ldots P_1P_0)=P_{n-2}\ldots P_1P_0P_{n-1}
\]</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>可以看到这里 000 和 111 并没有与其他点连接，因此我们需要有更多的操作。</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215215302.png" width=70%></div></p>
</div>
<p>两次混洗：</p>
<p><img alt="image-20241212110235394" src="../markdown-img/CA5.assets/image-20241212110235394.png" /></p>
<p>第三次混洗变回原来的样子。</p>
<p>可以看到经过 3 次 shuffle 后其他点都回到了原来的位置，但是 000 和 111 还是没有连接。因此我们在此的基础上加上 exchange 的连线（红色是通过 <span class="arithmatex">\(cube_0\)</span> 实现的）。</p>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215215546.png" width=70%></div>

<p>在这里任意两个节点相连最多需要 5 步，3 exchanges + 2 shuffles.</p>
<p>函数简单，可以适用于n足够大的情况。</p>
<p>The maximum distance of shuffle exchange network: (from the nodes numbered all “0” to all “1”) <strong>n</strong> exchanges and <strong>n-1</strong> shuffles, maximum distance: <strong>2n-1</strong> （<span class="arithmatex">\(n = log_2N\)</span>）</p>
<p>中间节点的距离较短，效率高，除了从全 0 到全 1 的距离远。</p>
<h4 id="others">Others<a class="headerlink" href="#others" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Linear array</p>
<p>开销低，但是每个点都是关键节点，一旦出现故障就会影响整个系统。
<div align = center><img src="https://cdn.hobbitqia.cc/20231215220123.png" width=20%></div>   </p>
</li>
<li>
<p>Circular array</p>
<p>任意一点断掉是不影响网络可用性的。</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215220149.png" width=20%></div></p>
<p>可以在点上加一些弦。
<div align = center><img src="https://cdn.hobbitqia.cc/20231215220232.png" width=20%></div></p>
</li>
<li>
<p>Tree array</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215220255.png" width=20%></div></p>
<p>可以拓展为带环的树（Tree with loop）、Binary fat tree
<div align = center><img src="https://cdn.hobbitqia.cc/20231215220325.png" width=40%></div></p>
</li>
<li>
<p>Star array</p>
<p>安全性较差，中间的节点非常重要。
<div align = center><img src="https://cdn.hobbitqia.cc/20231215220351.png" width=20%></div></p>
</li>
<li>
<p>Grid</p>
<p>格网络，在 GPU 中广泛使用。可以把蓝色的点视为开关控制。
<div align = center><img src="https://cdn.hobbitqia.cc/20231215220416.png" width=20%></div></p>
<p>可以拓展为 2D torus</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215220521.png" width=20%></div></p>
</li>
<li>
<p>Hypercube</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231215220544.png" width=50%></div></p>
<p>Cube 也可以加上环（Cube with loop）
<div align = center><img src="https://cdn.hobbitqia.cc/20231215220615.png" width=20%></div></p>
</li>
</ul>
<div align = center><img src="https://cdn.hobbitqia.cc/20231215220453.png" width=70%></div>

<p>注意到这些都是静态网络。</p>
<h3 id="25-multi-stage-interconnection-network-">2.5 Multi-stage interconnection network - 多级网络不考<a class="headerlink" href="#25-multi-stage-interconnection-network-" title="Permanent link">&para;</a></h3>
<p>// to be continued...</p>
<!--

通过交叉开关可以实现动态的网络。（根据传过来的信号决定开关是开还是关）

![image-20241212111512207](./markdown-img/CA5.assets/image-20241212111512207.png)

开关也有多种控制方式，可以每个开关都有自己的控制器，可以有一个全局的控制，也可以分级开关，每一级是一样的。

双功能开关不能满足我们的需求，因此我们会有下面这样的交叉开关：
<div align = center><img src="https://cdn.hobbitqia.cc/20231215222024.png" width=30%></div>

常用的办法是级控制，每一级的开关是一样的。
<div align = center><img src="https://cdn.hobbitqia.cc/20231215222115.png" width=70%></div>

不同的多级网络，他们的拓扑结构、交换方式（交叉开关）、控制方式可能不一样。

#### Switching unit

A switching unit with two inputs and two outputs is the basic component of various multi-level interconnection networks.

The statuses of switching unit:

* Straight
* Exchange
* Upper broadcast
* Lower broadcast

随着端口增加，这里可以有其他的开关单元，如 multicast 即组播，分组广播。

#### Multi-stage cube interconnection network

这里假设

* Switch unit: two-function switch unit

    在立方体里，我们只需要双功能开关。即 straight 和 exchange 即可。

* Control mode: stage, part stage and unit control
* Topology: cube structure

那么 N 个输入，我们需要 $n=\log_2N$ 级，每一级需要 $N/2$ 的交叉开关。

!!! Example "Three-stage cube interconnection network"
下面图是一个静态的拓扑结构，中间的布线是三级 cube 网络静态拓扑图，但是开关是可以变化的，因此变成动态了。由开关状态决定了具体是怎么连线的，本身的连线是静态的。
    <div align = center><img src="https://cdn.hobbitqia.cc/20231215222827.png" width=70%></div>

    我们把 012 的控制信号进行排列组合，可以得到 8 种不同的控制信号，会得到不同的网络。  
    这里我们改变三级开关的状态（0 表示 connect，1 表示 exchange），最左侧表示入端，表格中间是对应控制信号下的网络出端。
    <div align = center><img src="https://cdn.hobbitqia.cc/20231215223509.png" width=70%></div>

    通过状态也可以反推出控制信号。

!!! Example
    假设现在有 16 个处理器，我们要实现的是先对四组做 4 个元素的交换，再对两组做 8 个元素的交换，最后做一组 16 个元素的交换。
    <div align = center><img src="https://cdn.hobbitqia.cc/20231216003549.png" width=60%></div>

    对每一个端口，经过的操作是一样的，因此我们可以写出来这个函数

    $$
    f(P_3P_2P_1P_0)=\overline{P_3} P_2\overline{P_1}P_0
    $$

    我们可以通过函数反推出每级的控制信号。
    <div align = center><img src="https://cdn.hobbitqia.cc/20231216003718.png" width=60%></div>

#### Multi-stage shuffle exchange network

Multi-level shuffle exchange network is also called **Omega network**.

* The switch function has four functions

    四功能开关。（与立方体网络不同）

* The topological structure is shuffled topology followed by a four function switch
* Control mode is unit control

是立方体网络的逆网络。
<div align = center><img src="https://cdn.hobbitqia.cc/20231216004016.png" width=60%></div>


!!! Info "Similarity between omega and cube"
    如果我们限定 omega 网络的开关也只能用直连和交换两种功能，那么可以看到 omega 网络就是立方体网络的逆网络。
    <div align = center><img src="https://cdn.hobbitqia.cc/20231216004131.png" width=70%></div>

!!! Info "Difference between omega and cube"
    * The level of Omega network data flow: n-1, n-2,..., 1, 0.  
    The level of n-cube network data flow: 0, 1,..., n-1.
    * The Omega network uses a *four-function* exchange unit.  
    The n-cube network uses a *two-function* exchange unit.
    * Omega network can realize *one-to-many broadcasting* function.  
    N-cube network cannot achieve.

!!! Example 
    任意一个节点可以传到所有出端。
    <div align = center><img src="https://cdn.hobbitqia.cc/20231216004406.png" width=70%></div>

    对于 cube 网络，他无法同时实现 5-0 和 7-1，但 omega 可以。

<div align = center><img src="https://cdn.hobbitqia.cc/20231216004530.png" width=70%></div>

-->

<h2 id="3-dlp-in-gpu">3 DLP in GPU<a class="headerlink" href="#3-dlp-in-gpu" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><em>Heterogeneous</em> execution model</p>
</li>
<li>
<p>Unify all forms of GPU parallelism as <strong>CUDA thread</strong></p>
</li>
<li>Programming model is “<strong>Single Instruction Multiple Thread</strong>” - 单指令流多线程，从流水线的假并行到了真的并行</li>
</ul>
<p><strong>GPUs are really just multithreaded SIMD Processors</strong>. - 多线程的SIMD，仍然归属福林分类法之一</p>
<h3 id="programming-the-gpu-cuda">Programming the GPU: CUDA<a class="headerlink" href="#programming-the-gpu-cuda" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>CUDA</strong>: Compute Unified Device Architecture</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20231216005033.png" width=70%></div></p>
</div>
<p>前提条件：没有跨循环的相关，可以转换为向量（并行）处理；</p>
<p>每一个循环迭代会转换为一个独立的线程。</p>
<h3 id="grid-thread-blocks-and-threads">Grid, Thread Blocks and Threads<a class="headerlink" href="#grid-thread-blocks-and-threads" title="Permanent link">&para;</a></h3>
<ul>
<li>A <strong>thread</strong> is associated with each data element - 软件的程序员定义的</li>
<li>Threads are organized into <strong>blocks</strong> - 硬件manage的</li>
<li>Blocks are organized into a <strong>grid</strong></li>
</ul>
<p>GPU hardware handles thread management, not applications or OS.</p>
<div align = center><img src="https://cdn.hobbitqia.cc/20231216005125.png" width=70%></div>

<h3 id="gpu-memory-structures">GPU memory structures<a class="headerlink" href="#gpu-memory-structures" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>GPU memory</strong> is shared by all <em>Grids</em> (vectorized loops).</li>
<li><strong>Local memory</strong> is shared by all threads of SIMD instructions within <em>a Thread Block</em> (body of a vectorized loop). </li>
<li><strong>Private memory</strong> is private to <em>a single CUDA Thread</em>.</li>
</ul>
<div align = center><img src="https://cdn.hobbitqia.cc/20231216005138.png" width=70%></div>
<div align = center><img src="https://cdn.hobbitqia.cc/20231216005355.png" width=70%></div>

<p>相比单纯的向量处理阵列（左），GPU（右）多了使用<strong>硬件实现</strong>的线程调度机制，更快速和稳定（成本也高）：</p>
<p><img alt="image-20241219103203631" src="../markdown-img/CA5.assets/image-20241219103203631.png" /></p>
<h2 id="loop-level-parallelism-llp">Loop-Level Parallelism (LLP)<a class="headerlink" href="#loop-level-parallelism-llp" title="Permanent link">&para;</a></h2>
<p>做并行时不能有相互依赖。</p>
<p>Finding and manipulating loop-level parallelism is critical to exploiting both DLP and TLP, as well as the more aggressive static ILP approaches (e.g., VLIW).</p>
<p>Focuses on determining whether data accesses in later iterations are dependent on data values produced in earlier iterations.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="cm">/* S1 */</span>
<span class="w">    </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="cm">/* S2 */</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
S1 出现跨迭代的依赖，就不能用并行/向量链接，因为要等前一次操作的结果。S2 可以向量化（多个迭代并行）。</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="cm">/* S1 */</span>
<span class="w">    </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="cm">/* S2 */</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<p>​    交换 S1 S2，随后把第一次和最后一次运算提出去，可以改为下面这样，就可以并行。
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">99</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="cm">/* S2 */</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="cm">/* S1 */</span>
<span class="p">}</span>
<span class="n">B</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">99</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="mi">99</span><span class="p">];</span>
</code></pre></div></td></tr></table></div></p>
<p><img alt="image-20241219103621347" src="../markdown-img/CA5.assets/image-20241219103621347.png" /></p>
<p>绿色：名相关</p>
<p>橙色：数据传递</p>
<p>蓝色：输出相关</p>
<h2 id="mimd-tread-level-parallelism">MIMD: Tread-level Parallelism<a class="headerlink" href="#mimd-tread-level-parallelism" title="Permanent link">&para;</a></h2>
<p>线程级的并行，称为 TLP，是由软件系统来确认的。</p>
<p>The threads consist of hundreds to millions of instructions that may be executed in parallel.</p>
<p>粒度从单条指令变成了线程。</p>
<p>我们的发展从 ILP，到 TLP，再到 MIMD。</p>
<p>Multi-processor system 可以分为两大类：</p>
<ul>
<li>
<p>based on shared memory</p>
<p>系统中只有唯一的地址空间，所有进程共享。</p>
<p>并不代表只有一个物理上的内存，实际上可以通过一块<strong>物理共享</strong>的内存实现，也可以通过分布式的内存实现。</p>
</li>
<li>
<p>based on message passing</p>
<p>每个处理器都有自己的地址空间（有自己的权限管理），通过<strong>消息传递</strong>来通信、传送数据。</p>
</li>
</ul>
<h3 id="shared-memory-system">Shared Memory System<a class="headerlink" href="#shared-memory-system" title="Permanent link">&para;</a></h3>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110201622.png" width=70%></div>

<p>可以把共享内存划分为若干块，他们共同构成一个拼图（即统一的地址空间）。</p>
<p>有一个<strong>统一的操作系统</strong>（操作系统唯一），负责管理所有的信息、内存，给不同的进程使用内存。</p>
<p>If in a system, each CPU has equal access to all memory modules and input/output devices, and these CPUs are interchangeable in the operating system, then the system is a symmetric multiprocessor system <strong>SMP (Symmetric Multi-processor)</strong>.</p>
<h3 id="message-passing-system">Message Passing System<a class="headerlink" href="#message-passing-system" title="Permanent link">&para;</a></h3>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110202617.png" width=70%></div>

<p>每一个进程都有自己的内存，通过 ICN 来传递信息，可以共同完成任务。</p>
<p>一般每个进程<strong>有自己的 OS</strong>，但是组合在一起形成一个大的系统。</p>
<p>Communication in the system is achieved by using an <strong>interconnection network</strong> to pass messages.</p>
<p>可以分层次，ICN 也可以连接其他的 ICN，结点里可以是另一个多机系统。</p>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110202900.png" width=50%></div>

<h3 id="mimd-architecture">MIMD Architecture<a class="headerlink" href="#mimd-architecture" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Different memory access models of MIMD multiprocessor system</p>
<ul>
<li><strong>Uniform Memory Access (UMA)</strong></li>
<li><strong>Non Uniform Memory Access (NUMA)</strong></li>
<li><strong>Cache Only Memory Access (COMA)</strong></li>
</ul>
</li>
<li>
<p>Further division of MIMD multi-computer system</p>
<ul>
<li><strong>Massively Parallel Processors (MPP)</strong></li>
<li><strong>Cluster of Workstations(COW)</strong></li>
</ul>
</li>
</ul>
<h4 id="uma">UMA<a class="headerlink" href="#uma" title="Permanent link">&para;</a></h4>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110203036.png" width=50%></div>

<p>所有的物理存储器，由所有的进程一起使用，<strong>均匀共享</strong>，即没有进程对某个存储器有特殊的访问权限，访问的时间相同，即不存在谁离谁更近的问题。</p>
<p>进程可以有自己的拓展，比如 cache、IO、local memory。</p>
<p>因为他的高度共享性，UMA 也叫紧耦合系统。</p>
<ul>
<li>Physical memory is uniformly shared by all processors.</li>
<li>It takes the same time for all processors to access any memory word.</li>
<li>Each processor can be equipped with private cache or private memory.</li>
</ul>
<details class="example">
<summary>Example</summary>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20240110203433.png" width=60%></div></p>
</details>
<p>每个CPU也可以有自己的私有内存和cache</p>
<h4 id="numa">NUMA<a class="headerlink" href="#numa" title="Permanent link">&para;</a></h4>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110203501.png" width=50%></div>

<p>对某个进程都自己的 local memory，由 ICN 连起来。被共享的存储器是不均匀的。访问自己的 <strong>local memory 最快</strong>，访问别人的慢。</p>
<p>进程也可以有自己的拓展。</p>
<p>NUMA 有两种拓展，</p>
<ul>
<li>NC-NUMA: Non Cache NUMA 没cache</li>
<li>
<p>CC-NUMA: Coherent Cache NUMA 有cache</p>
<p>有自己的 cache 和目录，存在 cache 一致性的问题。当有一个数据改了，如何保证其他 cache 里的数据的正确性。多个cache从表现上不存在内存的不统一，好像只有一个cache一样。</p>
</li>
</ul>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110204714.png" width=55%></div>

<ul>
<li>All CPUs share an uniform address space</li>
<li>Use LOAD and STORE instructions to access remote memory</li>
<li>Access to remote memory is slower than access to local memory</li>
<li>The processor in the NUMA system can use cache</li>
</ul>
<div class="admonition note">
<p class="admonition-title">UMA and NUMA</p>
<ul>
<li>UMA is also called <strong>symmetric (shared-memory) multiprocessors (SMP)</strong> or <strong>centralized shared-memory multiprocessors</strong>.</li>
<li>NUMA is called <strong>distributed shared-memory multiprocessor (DSP)</strong>.</li>
</ul>
<p><div align = center><img src="https://cdn.hobbitqia.cc/20240110205135.png" width=55%></div></p>
<p>可以看到 UMA 有 shared cache，因此一致性是保证的。</p>
</div>
<h4 id="coma">COMA<a class="headerlink" href="#coma" title="Permanent link">&para;</a></h4>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110205326.png" width=50%></div>

<p>COMA 是 NUMA 模型的特例，每个进程之间不存在层次关系，可以组成一个全局的 cache。可以通过一个目录。</p>
<div align = center><img src="https://cdn.hobbitqia.cc/20240110205525.png" width=50%></div>

<ul>
<li>COMA is a special case of NUMA. There is no storage hierarchy in each processor node, and all caches form a uniform address space.</li>
<li>Use the distributed cache directory for remote cache access. When using COMA, the data can be allocated arbitrarily at the beginning, because it will eventually be moved to the place where it is used at runtime.</li>
</ul>
<h3 id="cache-coherence">Cache Coherence<a class="headerlink" href="#cache-coherence" title="Permanent link">&para;</a></h3>
<p><img alt="image-20241219121230683" src="../markdown-img/CA5.assets/image-20241219121230683.png" /></p>
<h4 id="memory-consistency-vs-cache-coherence">Memory Consistency VS Cache Coherence<a class="headerlink" href="#memory-consistency-vs-cache-coherence" title="Permanent link">&para;</a></h4>
<p>在Memory Consistency中，对一组先写后读的指令先读后写是错误的，需要保证指令执行的顺序性。Need Memory Consistency Model</p>
<p>In modern parallel computers, processors often have Cache. One memory data may have multiple copies in the entire system. This leads to the Cache coherence problem.  </p>
<p>可能有多个 cache，都放有内存拷贝的数据，可能不一致。我们一般通过一个协议来约定。Need Cache Coherence Protocol</p>
<ul>
<li>Bus snooping protocol</li>
<li>Directory based protocol</li>
</ul>
<p>协议主要是为了保证 cohrence 和 consistency.</p>
<ul>
<li>
<p>Coherence</p>
<p>读数据，读出来的一定是最新的数据（即刚被写过的值）。</p>
</li>
<li>
<p>Consistency</p>
<p>写一个值时，要把写的值返回（通过读指令），什么时候返回。</p>
</li>
</ul>
<h4 id="coherence">Coherence的保障<a class="headerlink" href="#coherence" title="Permanent link">&para;</a></h4>
<ul>
<li>A Write-Through cache with No-Write Allocation</li>
</ul>
<p><img alt="image-20241219112245687" src="../markdown-img/CA5.assets/image-20241219112245687.png" /></p>
<ul>
<li>A Write-Back cache with Write Allocation</li>
</ul>
<p><img alt="image-20241219112318855" src="../markdown-img/CA5.assets/image-20241219112318855.png" /></p>
<p>对于一致性协议，主要分为两大类：</p>
<ol>
<li>总线监听协议 - Snoopy coherence protocols - For UMA</li>
<li>共享目录协议 - Directory protocol - For NUMA</li>
</ol>
<p>使用有限状态机管理cache的状态，例如什么时候被更新，加入保持一致性的状态转化</p>
<p>MSI protocol：</p>
<ul>
<li>Invalid</li>
<li>Shared</li>
<li>Modified</li>
</ul>
<h4 id="snoopy-coherence-protocols">Snoopy Coherence Protocols<a class="headerlink" href="#snoopy-coherence-protocols" title="Permanent link">&para;</a></h4>
<p>For UMA, the cache coherence problem is solved by the <strong>snoopy protocol</strong>.</p>
<p>对于 write-through 和 write-back，我们有不同的解决方案。</p>
<ul>
<li>
<p>Write-through Cache Coherency Protocol</p>
<p><img alt="image-20241219114652248" src="../markdown-img/CA5.assets/image-20241219114652248.png" /></p>
</li>
</ul>
<p>Write Invalidation Protocol</p>
<p>把块的状态分为 </p>
<ul>
<li>Invalid</li>
<li>
<p>Shared</p>
<p>indicates that the block in the private cache is potentially shared.</p>
</li>
<li>
<p>Modified</p>
<p>indicates that the block has been updated in the private cache; implies that the block is exclusive.</p>
</li>
</ul>
<p><img alt="image-20241219114613784" src="../markdown-img/CA5.assets/image-20241219114613784.png" /></p>
<p>MSI 可以拓展为 MESI，多一个 exclusive。将其与 modified 区别开。
exclusive: indicates when a cache block is resident only in a single cache but is clean.</p>
<p>exclusive 时如果要读，就不能独占了，就会变为 shared。如果要写，就必须改为 modified。</p>
<p>MOESI</p>
<p>owned: indicates that the associated block is owned by that cache and out-of-date in memory.</p>
<p>Modified -&gt; Owned without writing the shared block to memory</p>
<p>MESI</p>
<ul>
<li>
<p>Invalid: The data contained in the cache item is invalid.</p>
<p>这个 CPU 里的缓存数据已经无效了（即在其他 CPU 里被改过了，而且还没有共享），CPU读数据的时候，没法读。</p>
</li>
<li>
<p>Shared: This row of data exists in multiple cache items, and the data in the memory is the latest.</p>
<p>多个 CPU 中都有自己的缓存。</p>
</li>
<li>
<p>Exclusive: No other cache items include this row of data, and the data in memory is the latest.</p>
<p>只有在自己的 CPU 里缓存，但是没有被修改，与内存一致。（因此其他 CPU 要读就可以改为 shared）--- 此CPU是唯一有效版本。</p>
</li>
<li>
<p>Modified: The data of the item is valid, but the data in the memory is invalid, and there is no copy of the data in other cache items.</p>
<p>被修改了。处于这个状态的数据只有在自己的 CPU 里才有缓存，这个时候还没有更新到内存里。</p>
</li>
</ul>
<p><img alt="image-20241219114855709" src="../markdown-img/CA5.assets/image-20241219114855709.png" /></p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>假设有两个 CPU。本地发一个 local write 的请求，如果发现所有 cache 中都没有这个地址（初始是 invalid），A 要写，对应 cache line 的状态就会变为 modified。CPU B 来读，发出 remote read，就变为了 shared（A 和 B 的 cache line 都是 share 的）。</p>
<p>如果 A 想写，B 也想，同时 A 先发起写，那么 A 中的 cache line 就变为 invalid。（只要有别人在我后面写，就变为无效） </p>
</div>
<p>False sharing</p>
<p>本身两个线程之间的变量没有关系，但是在同一个cacheline里面，会导致cache的状态频繁切换，性能降低：</p>
<p><img alt="image-20241219120044340" src="../markdown-img/CA5.assets/image-20241219120044340.png" /> <img alt="image-20241219120059941" src="../markdown-img/CA5.assets/image-20241219120059941.png" /></p>
<p>解决方式：</p>
<p>通过内存填充把两个变量分别放到两个cache：</p>
<p><img alt="image-20241219120137785" src="../markdown-img/CA5.assets/image-20241219120137785.png" /></p>
<p>Memory Consistency</p>
<p>宽松一致性模型 Relaxed Consistency Models</p>
<p>读写允许乱序，需要同步信息（保证程序正确性）</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>