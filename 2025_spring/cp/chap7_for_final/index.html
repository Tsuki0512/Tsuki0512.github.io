
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="wyr">
      
      
        <link rel="canonical" href="https://tsuki0512.github.io/2025_spring/cp/chap7_for_final/">
      
      
        <link rel="prev" href="../chap6_for_final/">
      
      
        <link rel="next" href="../chap8/">
      
      
      <link rel="icon" href="../../../assets/hzhf.jpg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>IR Trees - wyr's notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#7-translation-into-intermediate-code" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="wyr&#39;s notes" class="md-header__button md-logo" aria-label="wyr's notes" data-md-component="logo">
      
  <img src="../../../assets/hzhf.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            wyr's notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              IR Trees
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Tsuki0512/Tsuki0512.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Wyr's Notes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="wyr&#39;s notes" class="md-nav__button md-logo" aria-label="wyr's notes" data-md-component="logo">
      
  <img src="../../../assets/hzhf.jpg" alt="logo">

    </a>
    wyr's notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Tsuki0512/Tsuki0512.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Wyr's Notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    专业课程
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            专业课程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据结构基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            数据结构基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FDS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期中前内容
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FDS2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FDS3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    排序
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dip%E5%8E%86%E5%B9%B4%E5%8D%B7%E6%95%B4%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图像信息处理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E9%80%BB%E6%9C%9F%E6%9C%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数字逻辑设计
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ADS_%E5%A4%8D%E4%B9%A0%E6%95%B4%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高级数据结构与算法分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据库系统
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            数据库系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cheatingsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../minisql%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minisql分析
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../2024_fall/CA/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    计算机体系结构
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            计算机体系结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/CA/final_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期末复习
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/CA/CA1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机设计基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/CA/CA2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    流水线
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/CA/CA3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    内存层次
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/CA/CA4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    指令级并行
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/CA/CA5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DLP和TLP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/OS/final_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    操作系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../2024_fall/%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    计算理论
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            计算理论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Lec1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Lec2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024_fall/CN/CN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机网络
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    编译原理
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            编译原理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../midterm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期中梳理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lexical Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parsing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Abstract Syntax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantic Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type_checking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Type Checking (期末梳理版)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap6_for_final/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Activation Record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    IR Trees
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    IR Trees
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 中间表示概述
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#72" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 树形中间表示
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7.2 树形中间表示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#721" class="md-nav__link">
    <span class="md-ellipsis">
      7.2.1 表达式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#722" class="md-nav__link">
    <span class="md-ellipsis">
      7.2.2 语句
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#723" class="md-nav__link">
    <span class="md-ellipsis">
      7.2.3 例子
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#73-ir-trees" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 翻译到IR Trees
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7.3 翻译到IR Trees">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#731" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.1 翻译框架
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#732" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.2 翻译简单变量和数据结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#733" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.3 翻译控制流相关语句
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#734" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.4 函数翻译
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Blocks and Traces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instruction Selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Liveness Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Register Allocation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Garbage Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Object-Oriented Languages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loop Optimizations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    软件工程（学习中）
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            软件工程（学习中）
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../se/final/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    期末刷题记录
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_12" >
        
          
          <label class="md-nav__link" for="__nav_2_12" id="__nav_2_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    自然语言处理导论（待完善）
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_12">
            <span class="md-nav__icon md-icon"></span>
            自然语言处理导论（待完善）
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/DeepLearningBasics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deep Learning Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/WordEmbedding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Word Embedding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/ConvolutionalNeuralNetworks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convolutional Neural Networks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/RecurrentNeuralNetworks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recurrent Neural Networks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/Attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/NLGAndNMT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NLGandNMT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/Transformer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transformers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_13" >
        
          
          <label class="md-nav__link" for="__nav_2_13" id="__nav_2_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数理基础课程资源汇总
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_13">
            <span class="md-nav__icon md-icon"></span>
            数理基础课程资源汇总
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    离散数学及其应用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BE%AE%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    微积分（甲）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E7%89%A9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    大学物理（乙）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BA%BF%E4%BB%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性代数（甲）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C程序设计基础
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    论文阅读
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            论文阅读
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%9A%E6%A8%A1%E6%80%81/paper%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多模态大模型
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    课程心得
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            课程心得
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%80%9A%E8%AF%86%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    通识课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E7%90%86%E5%9F%BA%E7%A1%80%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数理基础课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E4%B8%93%E4%B8%9A%E5%BF%85%E4%BF%AE%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    专业必修课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E4%B8%93%E4%B8%9A%E9%80%89%E4%BF%AE%E8%AF%BE%E5%BF%83%E5%BE%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    专业选修课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A2%8E%E7%A2%8E%E5%BF%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一些碎碎念
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    CMU_DeepVision项目记录
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CMU_DeepVision项目记录
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_prelearning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线上课程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../pytorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pytorch入门
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0807/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec1 - Transformers and RAG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0807_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec2 - Ray Tracing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0809/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec3 - 3D Vision
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CMU_DeepVision_0816/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lec4 - Deep Learning Basics and Adversarial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 中间表示概述
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#72" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 树形中间表示
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7.2 树形中间表示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#721" class="md-nav__link">
    <span class="md-ellipsis">
      7.2.1 表达式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#722" class="md-nav__link">
    <span class="md-ellipsis">
      7.2.2 语句
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#723" class="md-nav__link">
    <span class="md-ellipsis">
      7.2.3 例子
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#73-ir-trees" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 翻译到IR Trees
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7.3 翻译到IR Trees">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#731" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.1 翻译框架
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#732" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.2 翻译简单变量和数据结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#733" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.3 翻译控制流相关语句
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#734" class="md-nav__link">
    <span class="md-ellipsis">
      7.3.4 函数翻译
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="7-translation-into-intermediate-code">7 Translation into Intermediate Code 中间代码生成<a class="headerlink" href="#7-translation-into-intermediate-code" title="Permanent link">&para;</a></h1>
<p>参考资料：</p>
<ul>
<li>姚培森老师2024~2025学年春夏ch7ppt</li>
<li><a href="https://shiseab.github.io/notebook/Compiler/ch7-IR/">wcjj的笔记</a></li>
<li><a href="https://docs.google.com/document/d/1mwpVoPyHAa_hlRk4K_bBlySJzOPcdAVA050EQWlPzhI/edit?usp=sharing">伟大的Gemini 2.5 pro deep research</a></li>
</ul>
<hr />
<h2 id="71">7.1 中间表示概述<a class="headerlink" href="#71" title="Permanent link">&para;</a></h2>
<p>为什么需要IR？- 使用中间介质简化编译的路径种类：</p>
<p><img alt="image-20250614181540848" src="../chap7_for_final.assets/image-20250614181540848.png" /></p>
<p>降低复杂性，提升复用性（hinders <strong>modularity</strong>, hinders <strong>portability</strong>）</p>
<p><strong>三地址码 TAC</strong></p>
<p>核心特点是每条指令最多只包含一个运算符和三个“地址”</p>
<p><img alt="image-20250614182633389" src="../chap7_for_final.assets/image-20250614182633389.png" /></p>
<p>例子：</p>
<p><img alt="image-20250614182656403" src="../chap7_for_final.assets/image-20250614182656403.png" /></p>
<h2 id="72">7.2 树形中间表示<a class="headerlink" href="#72" title="Permanent link">&para;</a></h2>
<p>中间表示在抽象语法树（AST）和底层汇编指令之间取得一个平衡点。一方面，它像AST一样保留了程序的层次化结构；另一方面，它的节点所代表的操作又非常接近于目标机器的指令，比如内存访问、二元运算等。</p>
<p>IR Tree由两大类节点构成</p>
<ul>
<li>用于计算值的<strong>表达式（Expression, Exp）</strong></li>
<li>用于执行动作的<strong>语句（Statement, Stmt）</strong></li>
</ul>
<p>文法描述：</p>
<p><img alt="image-20250614183733596" src="../chap7_for_final.assets/image-20250614183733596.png" /></p>
<h3 id="721">7.2.1 表达式<a class="headerlink" href="#721" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">节点 (Node)</th>
<th style="text-align: left;">功能描述 (Description)</th>
<th style="text-align: left;">示例 (Example)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">CONST(i)</td>
<td style="text-align: left;">整数常量i</td>
<td style="text-align: left;">CONST(42) → 值为42</td>
</tr>
<tr>
<td style="text-align: left;">NAME(n)</td>
<td style="text-align: left;">符号常量n，通常是一个代码标签（Label），其值为该标签的内存地址</td>
<td style="text-align: left;">NAME(L1) → 标签L1的地址</td>
</tr>
<tr>
<td style="text-align: left;">TEMP(t)</td>
<td style="text-align: left;">临时变量t，可以看作是一个虚拟寄存器，在寄存器分配前我们不关心其数量</td>
<td style="text-align: left;">TEMP(t123) → 临时变量t123中存储的内容</td>
</tr>
<tr>
<td style="text-align: left;">BINOP(o,e1,e2)</td>
<td style="text-align: left;">对两个子表达式e1和e2应用二元操作o（如加减乘除、位运算等）</td>
<td style="text-align: left;">BINOP(PLUS, TEMP(t1), CONST(1)) → 计算 t1 + 1</td>
</tr>
<tr>
<td style="text-align: left;">MEM(e)</td>
<td style="text-align: left;">访问内存，e是一个计算地址的表达式，MEM节点既可以表示从内存加载数据（fetch），也可以表示向内存存储数据（store），<code>MEM(e)</code>在左边就是写，在右边就是取</td>
<td style="text-align: left;">MEM(TEMP(fp)) → 访问帧指针fp所指向地址的内存内容</td>
</tr>
<tr>
<td style="text-align: left;">CALL(f,l)</td>
<td style="text-align: left;">调用函数f，参数列表为l，f通常是一个NAME节点，l是Exp节点的列表</td>
<td style="text-align: left;">CALL(NAME(print),[TEMP(t1)]) → 调用 print(t1)</td>
</tr>
<tr>
<td style="text-align: left;">ESEQ(s,e)</td>
<td style="text-align: left;">顺序组合，先执行语句s（为了其副作用），然后计算表达式e并返回其结果</td>
<td style="text-align: left;">ESEQ(MOVE(TEMP(t), CONST(1)), TEMP(t)) → (t=1; t)，整个表达式的结果是t的值，即1</td>
</tr>
</tbody>
</table>
<p><strong>ESEQ的理解和副作用：</strong></p>
<ul>
<li>
<p><code>s</code>可能会影响<code>e</code>的结果，导致有时候不可交换</p>
</li>
<li>
<p>ESEQ解决了在一个以“表达式求值”为核心的树状结构中，如何优雅地嵌入“产生副作用的语句”</p>
</li>
<li><strong>副作用（Side effects）</strong> 是指在计算表达式之外，对程序状态产生的任何可观察的改变，最常见的就是修改某个内存单元或临时变量（寄存器）的值</li>
<li>a=5这个赋值操作，其主要目的就是产生副作用（改变a的值），它本身不返回值</li>
<li>ESEQ(s, e)的语义是：先执行语句s，s的执行是为了其副作用，s本身不返回值。执行完s后，再计算表达式e，整个ESEQ节点的值就是e的值<ul>
<li>例如，ESEQ(MOVE(TEMP(a), CONST(5)), BINOP(PLUS, TEMP(a), CONST(5)))，会先执行MOVE语句使a的值变为5，然后计算a+5，最终整个表达式的结果是10</li>
</ul>
</li>
</ul>
<h3 id="722">7.2.2 语句<a class="headerlink" href="#722" title="Permanent link">&para;</a></h3>
<p>用于执行动作、改变状态或控制程序的执行流程，它们本身不返回任何值</p>
<table>
<thead>
<tr>
<th style="text-align: left;">节点 (Node)</th>
<th style="text-align: left;">功能描述 (Description)</th>
<th style="text-align: left;">示例 (Example)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">MOVE(d,s)</td>
<td style="text-align: left;">将源表达式s计算出的值，移动到目标位置d；d通常是TEMP或MEM节点，如果是MEM节点，表达式通常为MOVE(MEM(e1), e2)形式 - 计算e1，得到地址a，再计算e2，放入地址a</td>
<td style="text-align: left;">MOVE(TEMP(t1), CONST(42)) → t1 = 42</td>
</tr>
<tr>
<td style="text-align: left;">EXP(e)</td>
<td style="text-align: left;">计算表达式e，但完全忽略并丢弃其计算结果，这通常是为了利用e的副作用</td>
<td style="text-align: left;">EXP(CALL(NAME(print),...)) → 调用print()函数，不关心其返回值，只为了其打印效果</td>
</tr>
<tr>
<td style="text-align: left;">JUMP(e,labs)</td>
<td style="text-align: left;">无条件跳转，跳转到由表达式e计算出的地址，e通常是一个NAME节点</td>
<td style="text-align: left;">JUMP(NAME(L1), [L1]) → goto L1</td>
</tr>
<tr>
<td style="text-align: left;">CJUMP(o,e1,e2,t,f)</td>
<td style="text-align: left;">条件跳转，比较e1和e2（使用关系操作o），如果结果为真，则跳转到标签t；否则，跳转到标签f</td>
<td style="text-align: left;">CJUMP(LT, TEMP(t1), CONST(0), L1, L2) → if t1 &lt; 0 goto L1 else goto L2</td>
</tr>
<tr>
<td style="text-align: left;">SEQ(s1,s2)</td>
<td style="text-align: left;">语句序列，按顺序先执行语句s1，然后执行语句s2</td>
<td style="text-align: left;">SEQ(MOVE(...), JUMP(...)) → 先执行一个赋值语句，再执行一个跳转语句</td>
</tr>
<tr>
<td style="text-align: left;">LABEL(n)</td>
<td style="text-align: left;">定义标签，将符号名n的值定义为当前指令在内存中的地址，它作为跳转指令的目标。</td>
<td style="text-align: left;">LABEL(L1) → 定义一个名为L1的标签，相当于汇编中的 L1:</td>
</tr>
</tbody>
</table>
<p><em>Name是使用这个symbol，比如goto .L，而Label是定义这个symbol，即.L</em></p>
<h3 id="723">7.2.3 例子<a class="headerlink" href="#723" title="Permanent link">&para;</a></h3>
<p><img alt="image-20250614190436846" src="../chap7_for_final.assets/image-20250614190436846.png" /></p>
<ul>
<li>最外层的<code>SEQ</code>节点将整个代码块串联起来</li>
<li><code>MOVE(TEMP(n), CONST(0))</code>：对应循环前的初始化 <code>n := 0</code></li>
<li><code>LABEL(HEAD)</code>：定义了循环开始的标签，作为循环判断和返回的锚点</li>
<li><code>CJUMP(LT, TEMP(n), CONST(10), BODY, END)</code>：这是循环的核心判断。如果 <code>n &lt; 10</code> 为真，跳转到<code>BODY</code>标签；否则，跳转到<code>END</code>标签，退出循环</li>
<li><code>LABEL(BODY)</code>：定义了循环体的入口</li>
<li><code>MOVE(TEMP(n), BINOP(ADD, TEMP(n), CONST(1)))</code>：这是循环体的内容，对应 <code>n := n + 1</code></li>
<li><code>JUMP(NAME(HEAD))</code>：循环体执行完毕后，无条件跳转回<code>HEAD</code>标签，进行下一次循环判断</li>
<li><code>LABEL(END)</code>：定义了循环结束后的代码位置</li>
</ul>
<h2 id="73-ir-trees">7.3 翻译到IR Trees<a class="headerlink" href="#73-ir-trees" title="Permanent link">&para;</a></h2>
<p>我们的翻译以tiger文法为例：</p>
<p><img alt="image-20250614190728390" src="../chap7_for_final.assets/image-20250614190728390.png" /></p>
<h3 id="731">7.3.1 翻译框架<a class="headerlink" href="#731" title="Permanent link">&para;</a></h3>
<p>我们将AST表达式分为以下三类：</p>
<ul>
<li><strong><code>Ex</code></strong> - 一个能够计算出结果值的表达式<ul>
<li>它应该被翻译成一个<code>Tree.exp</code>节点</li>
<li>例如<code>a + b</code></li>
</ul>
</li>
<li><strong><code>Nx</code></strong> - 一个不产生任何结果值的语句<ul>
<li>它应该被翻译成一个<code>Tree.stmt</code>节点</li>
<li>例如赋值语句 <code>a := b</code> 或一个 <code>while</code> 循环</li>
</ul>
</li>
<li><strong><code>Cx</code></strong> - 一个用于控制流程的条件表达式<ul>
<li>它不直接计算出0或1，而是被翻译成一个能够根据条件真假跳转到不同目标标签的<code>Tree.stm</code></li>
<li>最典型的例子就是 <code>CJUMP</code></li>
</ul>
</li>
</ul>
<p>转换：例如，当<code>if</code>语句需要一个条件（<code>Cx</code>），而我们提供了一个<code>x+1</code>（<code>Ex</code>）时，<code>Ex -&gt; Cx</code>的转换会自动将<code>x+1</code>的结果与0比较，生成一个<code>CJUMP</code>。反之，当赋值语句需要一个值（<code>Ex</code>），而我们提供了一个<code>x&gt;0</code>（<code>Cx</code>）时，<code>Cx -&gt; Ex</code>的转换会生成一段代码，使用一个临时变量，当条件为真时给它赋值1，为假时赋值0，最后返回这个临时变量。</p>
<h3 id="732">7.3.2 翻译简单变量和数据结构<a class="headerlink" href="#732" title="Permanent link">&para;</a></h3>
<p><strong>简单变量访问</strong></p>
<p>在函数中访问一个局部变量，实际上是访问它在当前函数<strong>栈帧（Stack Frame</strong>中的存储位置，我们通过一个特殊的寄存器——<strong>帧指针（Frame Pointer, <code>fp</code>）</strong>来定位当前的栈帧。</p>
<p>因此，访问一个距离帧指针偏移量为<code>k</code>的局部变量<code>v</code>，其IR Tree表示为 ：  </p>
<p><span class="arithmatex">\(MEM(BINOP(PLUS,TEMP(fp),CONST(k)))\)</span></p>
<p>这棵树的含义是：取<code>fp</code>寄存器的值，加上常量偏移<code>k</code>，得到变量的实际内存地址，然后通过<code>MEM</code>节点访问该地址的内容。</p>
<p>静态链接：</p>
<p>对于支持嵌套函数的语言，一个内部函数可能需要访问定义在外部函数中的变量，这通过<strong>静态链接（Static Link）</strong>实现。访问一个嵌套层级为<code>n</code>的变量，需要沿着静态链进行<code>n</code>次解引用，其IR Tree会形成一个嵌套的<code>MEM</code>结构： </p>
<p><img alt="image-20250614195019938" src="../chap7_for_final.assets/image-20250614195019938.png" /></p>
<p>这表示从当前帧指针<code>fp</code>开始，首先找到指向外层函数栈帧的静态链接，然后一层层回溯，直到找到目标变量所在的栈帧，最后加上变量在该帧内的偏移量<code>k_x</code>来访问它。</p>
<p><strong>R值与L值 (R-Values and L-Values)</strong></p>
<ul>
<li><strong>R值 (R-value)</strong>：指表达式的“值”，通常出现在赋值号的右边，如 <code>a+3</code>。它是一个可以被计算但不能被赋值的量。</li>
<li><strong>L值 (L-value)</strong>：指一个可被赋值的“内存位置”，通常出现在赋值号的左边，如变量<code>x</code>、数组元素<code>a[i]</code>。它也可以出现在右边，此时表示该位置存储的“内容”。</li>
</ul>
<p>在IR Tree中，<code>MEM</code>节点的角色由其上下文决定：</p>
<ul>
<li>当作为<code>MOVE(d, s)</code>语句的目标<code>d</code>时，<code>MEM(...)</code>代表一个<strong>L值</strong>，表示要向这个内存地址<strong>存入（Store）</strong>数据</li>
<li>当出现在其他任何地方时，<code>MEM(...)</code>代表一个<strong>R值</strong>，表示要从这个内存地址<strong>取出（Fetch/Load）</strong>数据</li>
</ul>
<p>不同语言对L值的处理方式有很大差异：</p>
<ul>
<li><strong>标量L值 (Scalar L-value)</strong>：L值所代表的内存位置只包含一个不可再分的数据单元（如一个整数或一个指针）。Tiger语言的设计极大地简化了翻译，因为它规定<strong>所有变量都是标量</strong>。数组和记录变量本身只存储一个<strong>指针</strong>，这个指针是标量。</li>
<li><strong>结构化L值 (Structured L-value)</strong>：L值代表一块包含多个组成部分的内存区域，例如C语言中的结构体或Pascal中的数组。对结构化L值的赋值（如 <code>struct1 = struct2</code>）意味着要拷贝整个数据结构的内容，而不仅仅是一个指针。</li>
</ul>
<p>Tiger的“一切皆为标量指针”的设计哲学，意味着赋值操作永远是简单的单字（word-sized）拷贝，<code>MEM(e)</code>足以完成所有访存操作。而对于支持结构化L值的语言，编译器在生成IR时必须考虑数据的大小和对齐，可能需要生成特殊的块拷贝（block move）指令。</p>
<p><strong>算术运算</strong></p>
<p>算术运算的翻译相对直接：</p>
<ul>
<li><strong>二元运算</strong>：源语言中的加减乘除等二元运算符，直接映射到<code>BINOP(op, e1, e2)</code>节点</li>
<li><strong>一元运算</strong>：IR Tree中没有专门的一元运算节点，一元运算需要被转换为等价的二元运算<ul>
<li>一元取负 <code>-x</code> 被翻译为 <code>BINOP(MINUS, CONST(0), e_x)</code>，即 <code>0 - x</code></li>
<li>一元按位取反 <code>~x</code> 被翻译为 <code>BINOP(XOR, e_x, CONST(-1))</code>，即 <code>x XOR 0xFF..FF</code></li>
</ul>
</li>
</ul>
<hr />
<p><strong>数组下标<code>a[i]</code>访问</strong></p>
<p>数组和记录变量本身都是指针，访问数组元素<code>a[i]</code>需要两步：首先获取数组的基地址，然后计算元素的偏移地址。其IR Tree结构如下：</p>
<p><span class="arithmatex">\(MEM(BINOP(PLUS,MEM(e_a),BINOP(MUL,e_i,CONST(W))))\)</span></p>
<p>解释：</p>
<ol>
<li><code>e_a</code>是表示变量<code>a</code>的表达式，通常是 <code>MEM(+(TEMP(fp), CONST(k_a)))</code></li>
<li><code>MEM(e_a)</code>：<strong>第一次<code>MEM</code>访问</strong>。这是为了解引用指针，获取存储在变量<code>a</code>中的值，也就是数组在堆上的<strong>基地址</strong></li>
<li><code>e_i</code>是计算索引<code>i</code>的表达式</li>
<li><code>BINOP(MUL, e_i, CONST(W))</code>：计算索引偏移。将索引<code>i</code>乘以每个元素的大小<code>W</code>（Word size，例如4字节）</li>
<li><code>BINOP(PLUS,...)</code>：将基地址和索引偏移相加，得到目标元素的最终内存地址</li>
<li>最外层的<code>MEM(...)</code>：<strong>第二次<code>MEM</code>访问</strong>。访问上一步计算出的最终地址，获取或存入元素的值</li>
</ol>
<p><strong>记录字段<code>r.f</code>访问</strong></p>
<p>记录字段的访问与数组类似，但偏移量是固定的。如果字段<code>f</code>是记录的第<code>n</code>个字段（从0开始），其偏移量就是<code>n * W</code>。翻译结果为 ：  </p>
<p><span class="arithmatex">\(MEM(BINOP(PLUS,MEM(e_r),CONST(n∗W)))\)</span></p>
<p>这里的<code>MEM(e_r)</code>同样是用于获取记录在堆上的基地址。</p>
<h3 id="733">7.3.3 翻译控制流相关语句<a class="headerlink" href="#733" title="Permanent link">&para;</a></h3>
<p><strong><code>if-else</code>语句</strong></p>
<p>一个<code>if test then stmt1 else stmt2</code>语句会被翻译成如下结构的IR Tree ：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code>SEQ(CJUMP(op, e1, e2, t, f),
    SEQ(LABEL(t),
        SEQ(stm1,
            SEQ(JUMP(NAME(join)),
                SEQ(LABEL(f),
                    SEQ(stm2,
                        LABEL(join)))))))
</code></pre></div></td></tr></table></div>
<p>解释：</p>
<ol>
<li><code>CJUMP(...)</code>：对<code>test</code>表达式进行翻译，生成条件跳转。如果为真，跳到<code>t</code>标签（<code>then</code>分支的入口）；如果为假，跳到<code>f</code>标签（<code>else</code>分支的入口）</li>
<li><code>LABEL(t)</code> 和 <code>stm1</code>：<code>then</code>分支的代码</li>
<li><code>JUMP(NAME(join))</code>：<code>then</code>分支执行完毕后，无条件跳转到<code>join</code>标签，跳过<code>else</code>分支</li>
<li><code>LABEL(f)</code> 和 <code>stm2</code>：<code>else</code>分支的代码</li>
<li><code>LABEL(join)</code>：<code>then</code>和<code>else</code>分支的汇合点，程序从这里继续往下执行</li>
</ol>
<p><strong>逻辑运算符的短路求值</strong></p>
<ul>
<li>AND：
    <img alt="image-20250614201525195" src="../chap7_for_final.assets/image-20250614201525195.png" /></li>
<li>OR：
    <img alt="image-20250614201542767" src="../chap7_for_final.assets/image-20250614201542767.png" /></li>
</ul>
<p><strong><code>while</code>循环</strong></p>
<p>基本框架：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>SEQ(LABEL(test),
    SEQ(CJUMP(..., body, done),
        SEQ(LABEL(body),
            SEQ(body_stm,
                SEQ(JUMP(NAME(test)),
                    LABEL(done))))))
</code></pre></div></td></tr></table></div>
<ol>
<li><code>LABEL(test)</code>：循环判断的入口</li>
<li><code>CJUMP(...)</code>：对循环条件进行判断，若为真跳到<code>body</code>，否则跳到<code>done</code>退出循环</li>
<li><code>LABEL(body)</code> 和 <code>body_stm</code>：循环体的代码</li>
<li><code>JUMP(NAME(test))</code>：循环体执行完后，无条件跳回<code>test</code>进行下一次判断</li>
<li><code>LABEL(done)</code>：循环的出口</li>
</ol>
<p>有<code>break</code>则直接跳转到<code>done</code></p>
<p>例子：</p>
<p><img alt="image-20250614201853854" src="../chap7_for_final.assets/image-20250614201853854.png" /></p>
<p><strong><code>for</code>循环</strong></p>
<p>转换为<code>while</code>循环</p>
<p><img alt="image-20250614201926531" src="../chap7_for_final.assets/image-20250614201926531.png" /></p>
<h3 id="734">7.3.4 函数翻译<a class="headerlink" href="#734" title="Permanent link">&para;</a></h3>
<p><strong>函数调用</strong></p>
<p>翻译一个函数调用<code>f(a1,..., an)</code>，除了要处理所有参数表达式的求值外，一个关键点是处理支持嵌套函数所必需的<strong>静态链接（Static Link）</strong>，翻译结果为：</p>
<p><span class="arithmatex">\(CALL(NAME(l_f),[sl,a_1,...,a_n])\)</span></p>
<ul>
<li>这里的<code>sl</code>就是静态链接</li>
<li>它是一个隐藏的、额外的参数，指向<strong>调用者</strong>的<strong>静态父级</strong>函数的栈帧</li>
<li>当一个内层函数需要访问外层函数中定义的非局部变量时，它就通过静态链接（以及可能由多个静态链接组成的静态链）逐层回溯，找到定义该变量的栈帧，并从中读取数据 </li>
</ul>
<p><strong>函数声明</strong></p>
<ol>
<li><strong>序言 (Prologue)</strong>：函数开始执行前的一系列准备工作<ul>
<li>放置函数标签，使其可以被调用</li>
<li>调整栈指针（<code>sp</code>），为当前函数分配新的栈帧</li>
<li>将返回地址、旧的帧指针（<code>fp</code>）以及任何需要由被调用者保存的寄存器（callee-save registers）压入栈中，以便函数返回时恢复</li>
<li>处理传入的参数，包括将静态链接保存到当前栈帧的特定位置</li>
</ul>
</li>
<li><strong>函数体 (Body)</strong>：这是函数的核心逻辑。我们将函数内的表达式（在Tiger中，函数体就是一个表达式）翻译成IR Tree 。  </li>
<li><strong>尾声 (Epilogue)</strong>：函数返回前的一系列清理工作<ul>
<li>将函数的返回值（如果有的话）移动到约定的返回值寄存器中（如<code>eax</code>）</li>
<li>从栈中恢复之前保存的被调用者保存寄存器、旧的帧指针和返回地址</li>
<li>重置栈指针，释放当前函数的栈帧</li>
<li>执行返回指令，跳转到之前保存的返回地址，将控制权交还给调用者</li>
</ul>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>